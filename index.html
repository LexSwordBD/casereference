<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CaseReference | Legal Research Platform</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        /* ‡¶´‡¶®‡ßç‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßá‡¶∏‡¶ø‡¶ï */
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap');
        body { background-color: #f4f7f6; font-family: 'Hind Siliguri', 'Segoe UI', sans-serif; }
        
        /* ‡¶Æ‡ßá‡¶®‡ßÅ‡¶¨‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .navbar { background: #ffffff; box-shadow: 0 4px 12px rgba(0,0,0,0.05); padding: 15px 0; sticky-top; }
        .navbar-brand { font-size: 26px; font-weight: 700; color: #2c3e50 !important; }
        .navbar-brand span { color: #d35400; }
        .nav-link { color: #555 !important; font-weight: 600; margin-right: 15px; font-size: 16px; transition: 0.3s; }
        .nav-link:hover { color: #d35400 !important; }
        
        /* ‡¶π‡¶ø‡¶∞‡ßã ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        .hero-section { 
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); 
            padding: 80px 20px; text-align: center; color: white; margin-bottom: 0;
        }
        .hero-title { font-size: 42px; font-weight: 700; margin-bottom: 10px; }
        .hero-subtitle { font-size: 18px; opacity: 0.9; margin-bottom: 40px; }

        /* ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶¨‡¶ï‡ßç‡¶∏ */
        .search-container { max-width: 800px; margin: 0 auto; position: relative; }
        .search-input { 
            width: 100%; height: 60px; border-radius: 50px; border: none; 
            padding: 0 140px 0 30px; font-size: 18px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .search-input:focus { outline: none; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }
        .action-btns { position: absolute; right: 8px; top: 8px; }
        .btn-search { border-radius: 40px; padding: 10px 25px; font-weight: bold; background: #d35400; color: white; border: none; }
        
        /* ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ */
        .adv-search-panel { 
            display: none; background: #fff; color: #333; border-radius: 10px; 
            padding: 20px; margin-top: 20px; text-align: left;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶∏‡ßá‡¶ï‡¶∂‡¶® (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶®) */
        .packages-section { padding: 60px 20px; background: #fff; }
        .heading { text-align: center; font-weight: 700; color: #333; margin-bottom: 20px; }
        .heading span { color: #d35400; }
        .info-text { text-align: center; max-width: 800px; margin: 0 auto 40px auto; color: #666; font-size: 16px; line-height: 1.6; }
        
        .packages-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 30px; max-width: 1100px; margin: 0 auto; 
        }
        .package-card { 
            background: #fff; border: 1px solid #eee; border-radius: 15px; 
            padding: 30px 20px; text-align: center; transition: 0.3s; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); position: relative; overflow: hidden;
        }
        .package-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); border-color: #d35400; }
        .package-card i { font-size: 40px; color: #d35400; margin-bottom: 15px; }
        .package-card h3 { font-size: 22px; font-weight: 700; margin-bottom: 10px; }
        .package-card .price { font-size: 18px; color: #555; margin-bottom: 20px; }
        .package-card .price span { font-size: 28px; font-weight: 800; color: #2c3e50; }
        .package-card .btn { 
            background: #2c3e50; color: white; padding: 10px 25px; 
            border-radius: 5px; text-decoration: none; font-weight: 600; display: inline-block;
        }
        .package-card .btn:hover { background: #d35400; }

        /* ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
        .result-card { background: white; padding: 25px; border-radius: 8px; margin-bottom: 20px; border-left: 5px solid #d35400; box-shadow: 0 2px 5px rgba(0,0,0,0.05); cursor: pointer; transition: 0.2s; }
        .result-card:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .headnote-text { text-align: justify; color: #444; margin-top: 10px; font-size: 15px; }
        .highlight { background-color: #ffeb3b; padding: 2px 5px; border-radius: 3px; font-weight: bold; }

        /* ‡¶∞‡¶ø‡¶°‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤ */
        #readerView { display: none; background: white; padding: 50px; border-radius: 8px; font-family: 'Times New Roman', serif; font-size: 19px; line-height: 1.8; text-align: justify; margin-bottom: 50px; }
        .paywall-msg { display: none; text-align: center; padding: 60px; background: white; border-radius: 8px; margin-bottom: 50px; border: 1px solid #ddd; }

        /* ‡¶ö‡ßá‡¶ï ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .email-sent-icon { font-size: 60px; color: #27ae60; margin-bottom: 20px; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="location.reload()">Case<span>Reference</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('home')">‡¶π‡ßã‡¶Æ</a></li>
                    <li class="nav-item"><a class="nav-link" href="#packages">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡¶∏‡¶Æ‡ßÇ‡¶π</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a></li>
                    <li class="nav-item ms-2" id="authDiv">
                        </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="hero-section" id="homeSection">
        <div class="container">
            <h1 class="hero-title">Welcome to Case Reference</h1>
            <p class="hero-subtitle">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶¨‡ßÉ‡¶π‡¶§‡ßç‡¶§‡¶Æ ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶≤‡¶ø‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶æ‡¶á‡¶≠ ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ø‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ</p>
            
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="‡¶ï‡ßÄ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶§‡ßá ‡¶ö‡¶æ‡¶®? (‡¶Ø‡ßá‡¶Æ‡¶®: Murder, 75 DLR, Section 302)...">
                <div class="action-btns">
                    <button class="btn btn-light rounded-circle me-2" onclick="toggleAdvSearch()" title="Advanced Search"><i class="fas fa-sliders-h"></i></button>
                    <button class="btn-search" onclick="performSearch('simple')">Search</button>
                </div>

                <div class="adv-search-panel text-dark" id="advSearchForm">
                    <h5 class="mb-3 border-bottom pb-2">Advanced Filtering</h5>
                    <div class="row g-2">
                        <div class="col-md-3">
                            <label class="form-label small fw-bold">Journal</label>
                            <select id="advJournal" class="form-select"><option value="">Select...</option><option value="DLR">DLR</option><option value="BLD">BLD</option><option value="ADC">ADC</option></select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label small fw-bold">Volume</label>
                            <input type="text" id="advVol" class="form-control" placeholder="75">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label small fw-bold">Division</label>
                            <select id="advDiv" class="form-select"><option value="">Any</option><option value="AD">Appellate (AD)</option><option value="HCD">High Court (HCD)</option></select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label small fw-bold">Page</label>
                            <input type="text" id="advPage" class="form-control" placeholder="45">
                        </div>
                        <div class="col-md-2 d-flex align-items-end">
                            <button class="btn btn-dark w-100" onclick="performSearch('advanced')">Find Case</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-4">
        <div id="resultsArea"></div>
        <div id="readerView" class="shadow-sm"></div>
        
        <div id="paywallMsg" class="paywall-msg shadow">
            <i class="fas fa-lock fa-4x text-warning mb-3"></i>
            <h3>Premium Access Required</h3>
            <p class="lead">‡¶è‡¶á ‡¶ú‡¶æ‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶ü‡¶ø ‡¶™‡ßú‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞‡¶∂‡¶ø‡¶™ ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡•§</p>
            <p class="text-muted">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡ßá‡¶∞ ‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ ‡¶∂‡ßá‡¶∑ ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶®‡ßã ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶æ‡¶á‡¶¨ ‡¶ï‡¶∞‡ßá‡¶®‡¶®‡¶ø‡•§</p>
            <a href="#packages" class="btn btn-primary btn-lg mt-3 rounded-pill px-5">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶ì ‡¶∞‡¶ø‡¶®‡¶ø‡¶â ‡¶ï‡¶∞‡ßÅ‡¶®</a>
        </div>
    </div>

    <div class="packages-section" id="packages">
        <div class="container">
            <h1 class="heading">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü <span>‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span></h1>
            <p class="info-text">
                ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ø‡ßá ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶®‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶®, ‡¶∏‡ßá‡¶á ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡ßá‡¶∞ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶®‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®‡•§ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ <b>‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®</b> ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶´‡¶∞‡¶Æ‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶è‡¶ï‡¶ü‡¶ø‡¶≠ ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶¨‡•§
            </p>

            <div class="packages-grid">
                <div class="package-card">
                    <i class="fas fa-calendar-day"></i>
                    <h3>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï</h3>
                    <div class="price"><span>‡ßß‡ßØ‡ßØ‡ß≥</span> / ‡ßß ‡¶Æ‡¶æ‡¶∏</div>
                    <a class="btn" href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt199/4NosNL" target="_blank">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</a>
                </div>
                <div class="package-card">
                    <i class="fas fa-calendar-alt"></i>
                    <h3>‡¶§‡ßç‡¶∞‡ßà‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï</h3>
                    <div class="price"><span>‡ß™‡ßØ‡ßØ‡ß≥</span> / ‡ß© ‡¶Æ‡¶æ‡¶∏</div>
                    <a class="btn" href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt499/IxcDIa" target="_blank">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</a>
                </div>
                <div class="package-card">
                    <i class="fas fa-calendar-check"></i>
                    <h3>‡¶∑‡¶æ‡¶®‡ßç‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï</h3>
                    <div class="price"><span>‡ß≠‡ß¶‡ß¶‡ß≥</span> / ‡ß¨ ‡¶Æ‡¶æ‡¶∏</div>
                    <a class="btn" href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt700/LO7ESu" target="_blank">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</a>
                </div>
                <div class="package-card">
                    <i class="fas fa-award"></i>
                    <h3>‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï</h3>
                    <div class="price"><span>‡ßß‡ß®‡ß¶‡ß¶‡ß≥</span> / ‡ßß ‡¶¨‡¶õ‡¶∞</div>
                    <a class="btn" href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt1200/O3FBxR" target="_blank">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</a>
                </div>
            </div>

            <div class="text-center mt-5">
                <a class="btn btn-success btn-lg px-5 rounded-pill" href="https://www.casereference.com/p/contact-us_11.html?" target="_blank">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶´‡¶∞‡¶Æ)</a>
                <p class="mt-3 text-muted">‡¶π‡ßá‡¶≤‡ßç‡¶™‡¶≤‡¶æ‡¶á‡¶®: <b>‡ß¶‡ßß‡ßØ‡ßß‡ßß ‡ß¶‡ß¶‡ßÆ ‡ß´‡ßß‡ßÆ</b> (WhatsApp)</p>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-4 mt-5" id="contact">
        <div class="container">
            <h5>CaseReference BD</h5>
            <p class="small opacity-75">Bashundhara Riverview, Dhaka.</p>
            <p>Contact: 01911 008 518 | Email: legalvoicebd@gmail.com</p>
            <hr style="border-color: #555;">
            <p class="small mb-0">&copy; 2026 CaseReference. All Rights Reserved.</p>
        </div>
    </footer>

    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title fw-bold">My Account</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center" id="profileInfo">Checking...</div>
                <div class="modal-footer justify-content-center border-0">
                    <button class="btn btn-outline-danger btn-sm px-4" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="checkEmailModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4">
                <div class="modal-body">
                    <i class="fas fa-envelope-open-text email-sent-icon"></i>
                    <h3 class="mb-3">Check your Email</h3>
                    <p class="text-muted">‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶è‡¶ï‡¶ü‡¶ø <strong>Magic Login Link</strong> ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá‡¶õ‡¶ø‡•§</p>
                    <p class="alert alert-info small">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶®‡¶¨‡¶ï‡ßç‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≤‡¶ø‡¶Ç‡¶ï‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ (Spam ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞‡¶ì ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá‡¶®)</p>
                    <button type="button" class="btn btn-dark w-100 mt-3" data-bs-dismiss="modal">OK, I will check</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const supabaseUrl = 'https://bxzrydybnnlzrgzdqnob.supabase.co'; 
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4enJ5ZHlibm5senJnemRxbm9iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1NTQ2MzksImV4cCI6MjA4NDEzMDYzOX0.6Ikj5At5UKhKZr6y_lhmOQ-FUDxdnJOS1ZUSf6dTgEI'; 
        const githubUser = 'LexSwordBD'; 
        const repoName = 'casereference'; 
        const siteLink = 'https://lexswordbd.github.io/casereference/';
        // ============================================

        const _supabase = supabase.createClient(supabaseUrl, supabaseKey);
        let currentUser = null;
        let subStatus = false;
        let subExpiry = "Not Active";

        async function checkAuth() {
            const { data: { session } } = await _supabase.auth.getSession();
            const authDiv = document.getElementById('authDiv');
            
            if (session) {
                currentUser = session.user;
                const { data } = await _supabase.from('members').select('*').eq('email', currentUser.email).single();
                
                if(data && new Date(data.expiry_date) > new Date()) {
                    subStatus = true;
                    subExpiry = new Date(data.expiry_date).toDateString();
                } else {
                    subStatus = false;
                    subExpiry = "Expired / No Plan";
                }

                authDiv.innerHTML = `
                    <button class="btn btn-outline-dark rounded-pill px-3 fw-bold" data-bs-toggle="modal" data-bs-target="#profileModal">
                        <i class="fas fa-user-circle"></i> ${subStatus ? 'Premium' : 'Account'}
                    </button>`;
                
                document.getElementById('profileInfo').innerHTML = `
                    <img src="https://ui-avatars.com/api/?name=${currentUser.email}&background=random" class="rounded-circle mb-3" width="60">
                    <h5 class="fw-bold mb-1">${currentUser.email}</h5>
                    <p class="text-muted small mb-3">User ID: ${currentUser.id.substring(0,8)}...</p>
                    <div class="card bg-light border-0 p-3">
                        <p class="mb-1">Status: <span class="badge ${subStatus ? 'bg-success' : 'bg-warning text-dark'}">${subStatus ? 'Active Subscription' : 'Expired / Free'}</span></p>
                        <p class="mb-0 small">Valid Till: <strong>${subExpiry}</strong></p>
                    </div>
                    ${!subStatus ? '<a href="#packages" class="btn btn-primary w-100 mt-3" onclick="bootstrap.Modal.getInstance(document.getElementById(`profileModal`)).hide()">Upgrade Plan</a>' : ''}
                `;
            } else {
                authDiv.innerHTML = `<button class="btn btn-dark rounded-pill px-4 fw-bold" onclick="login()">Login / Signup</button>`;
            }
        }
        checkAuth();

        async function login() {
            const email = prompt("Enter your Email address:");
            if(email) {
                const { error } = await _supabase.auth.signInWithOtp({ email, options: { emailRedirectTo: siteLink } });
                if(!error) {
                    // ‡¶™‡ßç‡¶∞‡¶´‡ßá‡¶∂‡¶®‡¶æ‡¶≤ ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
                    new bootstrap.Modal(document.getElementById('checkEmailModal')).show();
                } else {
                    alert("Error: " + error.message);
                }
            }
        }

        async function logout() { await _supabase.auth.signOut(); location.reload(); }

        function toggleAdvSearch() {
            const panel = document.getElementById('advSearchForm');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        }

        async function performSearch(type) {
            const resultsDiv = document.getElementById('resultsArea');
            document.getElementById('readerView').style.display = 'none';
            document.getElementById('paywallMsg').style.display = 'none';
            // ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶∏‡ßá‡¶ï‡¶∂‡¶® ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶Ø‡¶æ‡¶§‡ßá ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ ‡¶•‡¶æ‡¶ï‡ßá
            document.getElementById('packages').style.display = 'none';
            document.getElementById('homeSection').style.padding = "40px 0";

            resultsDiv.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div></div>';

            let queryBuilder = _supabase.from('cases').select('*');
            let highlightTerm = "";

            if (type === 'advanced') {
                const jour = document.getElementById('advJournal').value;
                const vol = document.getElementById('advVol').value;
                const div = document.getElementById('advDiv').value;
                const pg = document.getElementById('advPage').value;
                if (!jour && !vol && !pg) { alert("Please fill at least Journal and Page."); return; }
                if(jour) queryBuilder = queryBuilder.eq('journal', jour);
                if(vol) queryBuilder = queryBuilder.eq('volume', vol);
                if(div) queryBuilder = queryBuilder.eq('division', div);
                if(pg) queryBuilder = queryBuilder.eq('page_number', pg);
                highlightTerm = `${jour} ${vol} ${pg}`;
            } else {
                const text = document.getElementById('searchInput').value;
                if (!text) return;
                queryBuilder = queryBuilder.or(`headnote.ilike.%${text}%,title.ilike.%${text}%`);
                highlightTerm = text;
            }

            const { data, error } = await queryBuilder.limit(20);

            if (error || !data.length) {
                resultsDiv.innerHTML = '<div class="text-center mt-5 text-muted"><h4>No cases found.</h4><p>Try adjusting your search terms.</p></div>';
                document.getElementById('packages').style.display = 'block'; // ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
                return;
            }

            resultsDiv.innerHTML = `<p class="text-muted mb-4">Found ${data.length} results matching "<strong>${highlightTerm}</strong>"</p>`;
            
            data.forEach(item => {
                const safeHeadnote = item.headnote || "No headnote available";
                const highlightedHeadnote = highlightText(safeHeadnote, highlightTerm);
                const div = document.createElement('div');
                div.className = 'result-card';
                div.onclick = () => loadJudgment(item);
                div.innerHTML = `
                    <div class="d-flex justify-content-between">
                        <h5 class="text-primary mb-1">${item.title}</h5>
                        ${item.is_premium ? '<span class="badge bg-danger"><i class="fas fa-lock"></i> Premium</span>' : '<span class="badge bg-success">Free</span>'}
                    </div>
                    <div class="mb-2 text-muted small">
                        <i class="fas fa-book me-1"></i> <strong>${item.citation}</strong> 
                        <span class="mx-2">|</span> 
                        <i class="fas fa-university me-1"></i> ${item.division || 'Court'}
                    </div>
                    <div class="headnote-text">${highlightedHeadnote}</div>
                `;
                resultsDiv.appendChild(div);
            });
        }

        function highlightText(text, keyword) {
            if (!keyword) return text;
            const regex = new RegExp(`(${keyword})`, "gi");
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        async function loadJudgment(item) {
            const viewer = document.getElementById('readerView');
            const paywall = document.getElementById('paywallMsg');
            document.getElementById('resultsArea').innerHTML = '';

            // ‡¶ï‡ßá‡¶∏ ‡ßß: ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶≤‡¶ó‡¶á‡¶® ‡¶®‡ßá‡¶á
            if (item.is_premium && !currentUser) {
                // ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡¶≤‡¶æ
                alert("üîí Premium Content\nPlease Login first to continue.");
                login();
                performSearch('simple'); // ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
                return;
            }

            // ‡¶ï‡ßá‡¶∏ ‡ß®: ‡¶≤‡¶ó‡¶á‡¶® ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ ‡¶®‡ßá‡¶á
            if (item.is_premium && !subStatus) {
                viewer.style.display = 'none';
                paywall.style.display = 'block';
                document.getElementById('packages').style.display = 'block'; // ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì ‡¶Ø‡¶æ‡¶§‡ßá ‡¶ï‡¶ø‡¶®‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
                // ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶∏‡ßá‡¶ï‡¶∂‡¶®‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶ï‡¶∞‡¶æ
                document.getElementById('packages').scrollIntoView({behavior: 'smooth'});
                return;
            }

            paywall.style.display = 'none';
            document.getElementById('packages').style.display = 'none'; // ‡¶™‡ßú‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã
            viewer.style.display = 'block';
            viewer.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-secondary"></div><p>Fetching full judgment...</p></div>';

            try {
                const url = `https://raw.githubusercontent.com/${githubUser}/${repoName}/main/judgments/${item.github_filename}`;
                const res = await fetch(url);
                const fullText = await res.text();
                const start = `===${item.case_anchor}===`;
                const end = `===End===`;
                const sIdx = fullText.indexOf(start);
                
                let content = "Error parsing file or marker not found.";
                if(sIdx !== -1) {
                    const eIdx = fullText.indexOf(end, sIdx);
                    if(eIdx !== -1) content = fullText.substring(sIdx + start.length, eIdx);
                }
                const searchTerm = document.getElementById('searchInput').value;
                if(searchTerm) content = highlightText(content, searchTerm);

                viewer.innerHTML = `
                    <div class="d-flex justify-content-between mb-4">
                        <button class="btn btn-outline-secondary btn-sm" onclick="location.reload()"><i class="fas fa-arrow-left"></i> Back</button>
                        <button class="btn btn-warning btn-sm" onclick="window.print()"><i class="fas fa-print"></i> Print</button>
                    </div>
                    <h2 class="text-center mb-2">${item.title}</h2>
                    <p class="text-center fw-bold text-muted mb-4 border-bottom pb-3">${item.citation}</p>
                    ${content}
                `;
            } catch (err) { viewer.innerHTML = `<div class="alert alert-danger">Error: ${err.message}</div>`; }
        }

        // ‡¶π‡ßã‡¶Æ ‡¶Æ‡ßá‡¶®‡ßÅ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
        function showSection(sec) {
            document.getElementById('packages').style.display = 'block';
            document.getElementById('homeSection').scrollIntoView({behavior: 'smooth'});
        }
    </script>
</body>
</html>
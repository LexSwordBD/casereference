<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CaseReference | Smart Legal Research</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&family=Hind+Siliguri:wght@400;500;600&display=swap');
        
        :root {
            --primary: #0f172a;
            --accent: #2563eb;
            --bg-body: #f8fafc;
            --surface: #ffffff;
            --text-main: #1e293b;
            --text-light: #64748b;
        }

        body { 
            background-color: var(--bg-body); 
            font-family: 'Inter', 'Hind Siliguri', sans-serif; 
            color: var(--text-main);
            overflow-x: hidden;
        }

        /* Navbar */
        .navbar { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0,0,0,0.05); padding: 15px 0; transition: 0.3s; }
        .navbar-brand { font-size: 26px; font-weight: 700; color: var(--primary) !important; font-family: 'Playfair Display', serif; }
        .navbar-brand span { color: var(--accent); }
        .nav-link { font-weight: 500; color: var(--text-main); font-size: 14px; margin: 0 10px; transition: 0.3s; }
        .nav-link:hover { color: var(--accent); }
        .btn-app { background: var(--text-main); color: white; border-radius: 50px; padding: 8px 20px; font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 8px; transition: 0.3s; text-decoration: none; }
        .btn-app:hover { background: var(--accent); color: white; }

        /* Hero Section (Collapsible) */
        .hero-section {
            min-height: 80vh; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: radial-gradient(circle at 50% 50%, #ffffff 0%, #f1f5f9 100%);
            padding: 20px; transition: all 0.5s ease-in-out;
        }
        
        /* Shrunk State */
        .hero-section.hero-shrunk {
            min-height: auto;
            padding-top: 100px;
            padding-bottom: 30px;
        }
        .hero-section.hero-shrunk .hero-title,
        .hero-section.hero-shrunk .hero-subtitle {
            display: none;
        }

        .hero-content { text-align: center; width: 100%; max-width: 900px; z-index: 2; }
        .hero-title { font-size: 48px; font-weight: 700; color: var(--primary); margin-bottom: 15px; font-family: 'Playfair Display', serif; }
        .hero-subtitle { font-size: 18px; color: var(--text-light); margin-bottom: 40px; }

        /* Search Bar */
        .search-container-box {
            background: var(--surface); padding: 10px; border-radius: 50px;
            box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.1); border: 1px solid rgba(0,0,0,0.05);
            display: flex; align-items: center; gap: 10px; transition: 0.3s;
        }
        .law-select-wrapper { position: relative; min-width: 250px; border-right: 1px solid #eee; padding-right: 10px; }
        .law-input { width: 100%; border: none; font-size: 14px; font-weight: 600; color: var(--primary); background: transparent; outline: none; padding: 10px 20px; }
        .main-input { flex-grow: 1; border: none; font-size: 16px; outline: none; color: var(--text-main); padding: 10px; background: transparent; }
        
        .btn-search-hero {
            background: var(--accent); color: white; border: none;
            width: 50px; height: 50px; border-radius: 50%; font-size: 18px; transition: 0.3s;
        }
        
        /* Advanced Panel */
        .adv-search-panel { display: none; background: #fff; border-radius: 12px; padding: 25px; margin-top: 15px; text-align: left; color: #333; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid #eee; }

        /* Features */
        .features-section { padding: 40px 15px; margin-top: 20px; }
        .feature-icon { font-size: 24px; color: var(--accent); margin-bottom: 10px; }

        /* Result List */
        .result-item {
            background: var(--surface); border: 1px solid #f1f5f9; padding: 25px; border-radius: 12px;
            margin-bottom: 15px; transition: 0.2s; cursor: pointer;
        }
        .result-item:hover { border-color: var(--accent); box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .result-item h5 { color: var(--accent); font-family: 'Playfair Display', serif; font-weight: 700; font-size: 20px; }
        .headnote-text { text-align: justify; font-size: 15px; line-height: 1.7; color: #475569; margin-top: 10px; white-space: pre-wrap; }
        .highlight { background-color: #fef08a; padding: 0 2px; border-radius: 2px; }

        /* Pricing (Screenshot Style) */
        .packages-section { padding: 60px 15px; background: #fff; }
        .pricing-card {
            background: #f8fafc; /* Light Grayish */
            padding: 40px 30px; border-radius: 20px; text-align: center;
            border: 1px solid transparent; transition: 0.3s; position: relative; overflow: hidden;
        }
        .pricing-card.popular {
            background: #ffffff;
            border: 2px solid var(--accent);
            box-shadow: 0 20px 40px rgba(37, 99, 235, 0.1);
        }
        .best-value-badge {
            position: absolute; top: 20px; right: -35px; background: var(--accent); color: white;
            padding: 5px 40px; transform: rotate(45deg); font-size: 10px; font-weight: bold; letter-spacing: 1px;
        }
        .plan-name { font-size: 18px; font-weight: 600; color: var(--text-light); margin-bottom: 10px; }
        .plan-price { font-size: 42px; font-weight: 700; color: var(--primary); font-family: 'Inter', sans-serif; }
        .plan-desc { font-size: 14px; color: #94a3b8; margin-bottom: 30px; }
        .btn-plan {
            display: block; width: 100%; padding: 12px; border-radius: 8px; font-weight: 600;
            background: var(--primary); color: white; text-decoration: none; transition: 0.3s;
        }
        .btn-plan:hover { background: var(--accent); }
        .pricing-card:not(.popular) .btn-plan { background: #e2e8f0; color: var(--text-main); }
        .pricing-card:not(.popular) .btn-plan:hover { background: #cbd5e1; }

        /* Footer */
        footer { background: #111; color: #888; padding: 60px 0; font-size: 14px; text-align: center; }
        .footer-link { color: #888; text-decoration: none; margin: 0 10px; transition: 0.3s; }
        .footer-link:hover { color: white; }

        /* Mobile Tweaks */
        @media (max-width: 768px) {
            .hero-title { font-size: 32px; }
            .hero-section { min-height: auto; padding-top: 100px; padding-bottom: 50px; }
            /* Mobile Search Box Separation */
            .search-container-box { 
                background: transparent; box-shadow: none; border: none; 
                flex-direction: column; padding: 0; align-items: stretch; gap: 15px; 
            }
            .law-select-wrapper { 
                background: white; border-radius: 50px; border: 1px solid #e2e8f0; 
                padding: 5px 15px; width: 100%; 
            }
            .main-input { 
                background: white; border-radius: 50px; border: 1px solid #e2e8f0; 
                padding: 15px 20px; width: 100%; 
            }
            .btn-search-hero { width: 100%; border-radius: 50px; }
            .col-6 { padding: 5px; }
        }
        
        .whatsapp-float { position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px; background-color: #25d366; color: white; border-radius: 50%; text-align: center; line-height: 60px; font-size: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 1000; }
        
        /* Modals & Forms */
        .modal-content { border-radius: 15px; border: none; }
        .modal-header { background: var(--primary); color: white; }
        .form-control, .form-select { padding: 12px; border-radius: 8px; font-size: 15px; }
        .pagination { justify-content: center; margin-top: 30px; padding-bottom: 50px; }
        .page-link { color: var(--text-dark); border: none; margin: 0 5px; border-radius: 5px; font-weight: 600; }
        .page-link.active { background-color: var(--accent); color: white; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="location.reload()">Case<span>Reference</span></a>
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#" onclick="resetHome()">Home</a></li>
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#" onclick="showMyBookmarks()">Bookmarks</a></li>
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#packages">Pricing</a></li>
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#contact">Contact</a></li>
                    <li class="nav-item">
                        <a class="btn-app ms-lg-3 mt-3 mt-lg-0" href="#" data-bs-toggle="modal" data-bs-target="#appModal">
                            <i class="fab fa-android"></i> Get App
                        </a>
                    </li>
                    <li class="nav-item ms-lg-3 mt-3 mt-lg-0" id="authDiv"></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="hero-section" id="homeSection">
        <div class="hero-content">
            <h1 class="hero-title">Intelligent Legal Research.</h1>
            <p class="hero-subtitle">Search over 50,000+ judgments from the Supreme Court of Bangladesh.</p>
            
            <div class="search-container">
                <div class="search-container-box">
                    <div class="law-select-wrapper">
                        <input class="law-input" list="lawList" id="lawFilterInput" placeholder="Select Law (e.g. Penal Code)">
                       <datalist id="lawList">
    <option value="Constitution of Bangladesh (‡¶∏‡¶Ç‡¶¨‡¶ø‡¶ß‡¶æ‡¶®)">
    <option value="General Clauses Act (‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßç‡¶≤‡¶ú‡ßá‡¶∏)">

    <option value="Code of Civil Procedure (CPC/‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶®‡ßÄ)">
    <option value="Civil Courts Act (‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶®‡ßÄ ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§)">
    <option value="Court Fees Act (‡¶ï‡ßã‡¶∞‡ßç‡¶ü ‡¶´‡¶ø)">
    <option value="Suit Valuation Act (‡¶Æ‡ßã‡¶ï‡¶¶‡ßç‡¶¶‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶Æ‡¶æ‡¶®)">
    <option value="Limitation Act (‡¶§‡¶æ‡¶Æ‡¶æ‡¶¶‡¶ø ‡¶Ü‡¶á‡¶®)">
    <option value="Specific Relief Act (‡¶∏‡ßÅ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡¶æ‡¶∞)">
    <option value="Evidence Act (‡¶∏‡¶æ‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶Ü‡¶á‡¶®)">
    <option value="Oaths Act (‡¶∂‡¶™‡¶• ‡¶Ü‡¶á‡¶®)">

    <option value="Code of Criminal Procedure (CrPC/‡¶´‡ßå‡¶ú‡¶¶‡¶æ‡¶∞‡ßÄ)">
    <option value="Penal Code (‡¶¶‡¶£‡ßç‡¶°‡¶¨‡¶ø‡¶ß‡¶ø)">
    <option value="Arms Act (‡¶Ö‡¶∏‡ßç‡¶§‡ßç‡¶∞ ‡¶Ü‡¶á‡¶®)">
    <option value="Explosive Substances Act (‡¶¨‡¶ø‡¶∏‡ßç‡¶´‡ßã‡¶∞‡¶ï ‡¶¶‡ßç‡¶∞‡¶¨‡ßç‡¶Ø)">
    <option value="Anti-Terrorism Act (‡¶∏‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶æ‡¶∏ ‡¶¨‡¶ø‡¶∞‡ßã‡¶ß‡ßÄ)">
    <option value="Special Powers Act (‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ)">
    <option value="Narcotics Control Act (‡¶Æ‡¶æ‡¶¶‡¶ï ‡¶¶‡ßç‡¶∞‡¶¨‡ßç‡¶Ø)">
    <option value="Prevention of Corruption Act (‡¶¶‡ßÅ‡¶∞‡ßç‡¶®‡ßÄ‡¶§‡¶ø ‡¶¶‡¶Æ‡¶®)">
    <option value="Money Laundering Prevention Act (‡¶Æ‡¶æ‡¶®‡¶ø ‡¶≤‡¶®‡ßç‡¶°‡¶æ‡¶∞‡¶ø‡¶Ç)">
    <option value="Human Trafficking Deterrence Act (‡¶Æ‡¶æ‡¶®‡¶¨ ‡¶™‡¶æ‡¶ö‡¶æ‡¶∞)">
    <option value="Acid Crime Control Act (‡¶è‡¶∏‡¶ø‡¶° ‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß)">
    <option value="Pornography Control Act (‡¶™‡¶∞‡ßç‡¶®‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶´‡¶ø ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£)">
    <option value="Ain Srinkhola Bighnokari Oporadh (‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶¨‡¶ø‡¶ö‡¶æ‡¶∞)">
    <option value="Mobile Court Act (‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶ï‡ßã‡¶∞‡ßç‡¶ü)">
    <option value="Dowry Prohibition Act (‡¶Ø‡ßå‡¶§‡ßÅ‡¶ï ‡¶®‡¶ø‡¶∞‡ßã‡¶ß)">
    <option value="Cruelty to Women (Deterrent Punishment) Ordinance">
    <option value="Children Act (‡¶∂‡¶ø‡¶∂‡ßÅ ‡¶Ü‡¶á‡¶®)">

    <option value="Nari O Shishu Nirjatan Daman Ain (‡¶®‡¶æ‡¶∞‡ßÄ ‡¶ì ‡¶∂‡¶ø‡¶∂‡ßÅ)">
    <option value="Child Marriage Restraint Act (‡¶¨‡¶æ‡¶≤‡ßç‡¶Ø‡¶¨‡¶ø‡¶¨‡¶æ‡¶π ‡¶®‡¶ø‡¶∞‡ßã‡¶ß)">
    <option value="Domestic Violence (Prevention and Protection) Act">

    <option value="Transfer of Property Act (‡¶∏‡¶Æ‡ßç‡¶™‡¶§‡ßç‡¶§‡¶ø ‡¶π‡¶∏‡ßç‡¶§‡¶æ‡¶®‡ßç‡¶§‡¶∞)">
    <option value="Registration Act (‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®)">
    <option value="State Acquisition and Tenancy Act (‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨/SAT)">
    <option value="Non-Agricultural Tenancy Act (‡¶Ö‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨)">
    <option value="Public Demands Recovery Act (PDRA/‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡¶æ‡¶ì‡¶®‡¶æ)">
    <option value="Acquisition and Requisition of Immovable Property Act">
    <option value="Vested Property Return Act (‡¶Ö‡¶∞‡ßç‡¶™‡¶ø‡¶§ ‡¶∏‡¶Æ‡ßç‡¶™‡¶§‡ßç‡¶§‡¶ø)">
    <option value="Land Development Tax Ordinance (‡¶≠‡ßÇ‡¶Æ‡¶ø ‡¶â‡¶®‡ßç‡¶®‡ßü‡¶® ‡¶ï‡¶∞)">
    <option value="Trust Act (‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶Ü‡¶á‡¶®)">
    <option value="Easements Act (‡¶á‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü/‡¶∏‡ßÅ‡¶ñ‡¶æ‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞)">
    <option value="Partition Act (‡¶¨‡¶æ‡¶ü‡ßã‡ßü‡¶æ‡¶∞‡¶æ)">
    <option value="Premises Rent Control Act (‡¶¨‡¶æ‡ßú‡¶ø ‡¶≠‡¶æ‡ßú‡¶æ)">
    <option value="Abandoned Buildings Ordinance (‡¶™‡¶∞‡¶ø‡¶§‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶§ ‡¶∏‡¶Æ‡ßç‡¶™‡¶§‡ßç‡¶§‡¶ø)">
    <option value="Waqf Ordinance (‡¶ì‡ßü‡¶æ‡¶ï‡¶´)">

    <option value="Muslim Family Laws Ordinance (‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ ‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï)">
    <option value="Family Courts Ordinance (‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§)">
    <option value="Muslim Marriages and Divorces Registration Act">
    <option value="Dissolution of Muslim Marriages Act">
    <option value="Guardians and Wards Act (‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï ‡¶ì ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶Ø)">
    <option value="Succession Act (‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶æ‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞)">
    <option value="Hindu Law (‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶Ü‡¶á‡¶®)">
    <option value="Christian Marriage Act">
    <option value="Divorce Act (1869)">

    <option value="Artha Rin Adalat Ain (‡¶Ö‡¶∞‡ßç‡¶• ‡¶ã‡¶£ ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§)">
    <option value="Negotiable Instruments Act (NI Act/‡¶ö‡ßá‡¶ï ‡¶°‡¶ø‡¶ú‡¶Ö‡¶®‡¶æ‡¶∞)">
    <option value="Contract Act (‡¶ö‡ßÅ‡¶ï‡ßç‡¶§‡¶ø ‡¶Ü‡¶á‡¶®)">
    <option value="Companies Act (‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø ‡¶Ü‡¶á‡¶®)">
    <option value="Partnership Act (‡¶Ö‡¶Ç‡¶∂‡ßÄ‡¶¶‡¶æ‡¶∞‡¶ø‡¶§‡ßç‡¶¨)">
    <option value="Arbitration Act (‡¶∏‡¶æ‡¶≤‡¶ø‡¶∂ ‡¶Ü‡¶á‡¶®)">
    <option value="Bankruptcy Act (‡¶¶‡ßá‡¶â‡¶≤‡¶ø‡ßü‡¶æ ‡¶Ü‡¶á‡¶®)">
    <option value="Bank Company Act (‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø)">
    <option value="Insurance Act (‡¶¨‡ßÄ‡¶Æ‡¶æ ‡¶Ü‡¶á‡¶®)">
    <option value="Financial Institutions Act (‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®)">
    <option value="Competition Act (‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ ‡¶Ü‡¶á‡¶®)">
    <option value="Foreign Exchange Regulation Act">

    <option value="Bangladesh Labor Act (‡¶∂‡ßç‡¶∞‡¶Æ ‡¶Ü‡¶á‡¶®)">
    <option value="Administrative Tribunals Act (‡¶™‡ßç‡¶∞‡¶∂‡¶æ‡¶∏‡¶®‡¶ø‡¶ï ‡¶ü‡ßç‡¶∞‡¶æ‡¶á‡¶¨‡ßÅ‡¶®‡¶æ‡¶≤)">
    <option value="Public Servants (Dismissal on Conviction) Ordinance">
    <option value="Government Servants (Discipline and Appeal) Rules">

    <option value="Income Tax Act (‡¶Ü‡ßü‡¶ï‡¶∞)">
    <option value="Value Added Tax (VAT) Act (‡¶Æ‡ßÇ‡¶∏‡¶ï)">
    <option value="Customs Act (‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶∏)">
    <option value="Excise and Salt Act">

    <option value="Digital Security Act (‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ)">
    <option value="Cyber Security Act (‡¶∏‡¶æ‡¶á‡¶¨‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ)">
    <option value="Information and Communication Technology Act (ICT)">
    <option value="Right to Information Act (‡¶§‡¶•‡ßç‡¶Ø ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞)">
    <option value="Telecommunication Act">

    <option value="Environment Conservation Act (‡¶™‡¶∞‡¶ø‡¶¨‡ßá‡¶∂ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£)">
    <option value="Forest Act (‡¶¨‡¶® ‡¶Ü‡¶á‡¶®)">
    <option value="Road Transport Act (‡¶∏‡ßú‡¶ï ‡¶™‡¶∞‡¶ø‡¶¨‡¶π‡¶®)">
    <option value="Motor Vehicles Ordinance">
    <option value="Consumer Rights Protection Act (‡¶≠‡ßã‡¶ï‡ßç‡¶§‡¶æ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞)">
    <option value="Food Safety Act (‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶ñ‡¶æ‡¶¶‡ßç‡¶Ø)">
    <option value="Representation of the People Order (RPO/‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®)">
    <option value="Local Government (Union Parishad) Act">
    <option value="Local Government (Pourashava) Act">
    <option value="Local Government (City Corporation) Act">
    <option value="Upazila Parishad Act">
    <option value="Electricity Act (‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡ßÅ‡ßé ‡¶Ü‡¶á‡¶®)">
    <option value="Real Estate Development and Management Act">
</datalist>
                    </div>

                    <input type="text" id="searchInput" class="main-input" maxlength="100" placeholder="Search keywords, citations, or case names...">
                    
                    <button class="btn btn-link text-secondary" onclick="toggleAdvSearch()" title="Advanced Filters"><i class="fas fa-sliders-h"></i></button>
                    <button class="btn-search-hero" onclick="triggerSearch(1)"><i class="fas fa-arrow-right"></i></button>
                </div>

                <div class="d-flex justify-content-center gap-3 mt-3">
                    <label class="small text-secondary" style="cursor:pointer;">
                        <input type="checkbox" id="exactMatchToggle"> Exact Phrase Match
                    </label>
                </div>

                <div class="adv-search-panel" id="advSearchForm">
                    <h6 class="small fw-bold text-uppercase text-secondary mb-3">Citation Search</h6>
                    <div class="row g-2">
                        <div class="col-6 col-md-3"><select id="advJournal" class="form-select form-select-sm"><option value="">Journal</option><option>DLR</option><option>BLD</option><option>ADC</option><option>MLR</option><option>BLC</option></select></div>
                        <div class="col-6 col-md-2"><input type="text" id="advVol" class="form-control form-control-sm" placeholder="Vol"></div>
                        <div class="col-6 col-md-3"><select id="advDiv" class="form-select form-select-sm"><option value="">Division</option><option>AD</option><option>HCD</option></select></div>
                        <div class="col-6 col-md-2"><input type="text" id="advPage" class="form-control form-control-sm" placeholder="Page"></div>
                        <div class="col-12 col-md-2"><button class="btn btn-dark btn-sm w-100" onclick="triggerSearch(1, 'advanced')">Go</button></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" style="min-height: 400px;">
        <div id="resultsArea"></div>
        <nav id="paginationNav" style="display:none;"><ul class="pagination" id="paginationList"></ul></nav>
        
        <div id="readerView" class="bg-white p-4 p-md-5 rounded-3 shadow-sm border mb-5" style="display:none;"></div>
        <div id="bookmarkArea" style="display:none;" class="mb-5"><h3 class="mb-4">My Bookmarks</h3><div id="bookmarkList"></div></div>

        <div id="featuresSection" class="py-5">
            <div class="row g-4 justify-content-center text-center">
                <div class="col-6 col-md-3"><i class="fas fa-bolt fa-2x text-warning mb-3"></i><h6 class="fw-bold">Fast Search</h6></div>
                <div class="col-6 col-md-3"><i class="fas fa-book fa-2x text-primary mb-3"></i><h6 class="fw-bold">All Laws</h6></div>
                <div class="col-6 col-md-3"><i class="fas fa-mobile-alt fa-2x text-success mb-3"></i><h6 class="fw-bold">Mobile First</h6></div>
                <div class="col-6 col-md-3"><i class="fas fa-headset fa-2x text-secondary mb-3"></i><h6 class="fw-bold">24/7 Support</h6></div>
            </div>
        </div>
        
        <div id="paywallMsg" class="text-center py-5 bg-white rounded shadow-sm border" style="display:none; margin-bottom:50px;">
            <i class="fas fa-crown fa-3x text-warning mb-3"></i>
            <h3>Premium Access Required</h3>
            <p class="text-muted">Please subscribe to view this judgment.</p>
            <a href="#packages" class="btn btn-dark rounded-pill px-5 mt-2">View Plans</a>
        </div>
    </div>

    <div class="packages-section" id="packages">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="hero-title" style="font-size:32px;">Simple, Transparent Pricing</h2>
                <p class="text-muted">Choose the plan that fits your practice.</p>
            </div>
            <div class="row g-4 justify-content-center">
                <div class="col-md-3 col-sm-6">
                    <div class="pricing-card">
                        <div class="plan-name">Monthly</div>
                        <div class="plan-price">199‡ß≥</div>
                        <div class="plan-desc">Billed monthly</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt199/4NosNL" target="_blank" class="btn-plan">Get Started</a>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="pricing-card popular">
                        <div class="best-value-badge">BEST VALUE</div>
                        <div class="plan-name">Quarterly</div>
                        <div class="plan-price">499‡ß≥</div>
                        <div class="plan-desc">Save 15%</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt499/IxcDIa" target="_blank" class="btn-plan">Get Started</a>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="pricing-card">
                        <div class="plan-name">Yearly</div>
                        <div class="plan-price">1200‡ß≥</div>
                        <div class="plan-desc">Save 50%</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt1200/O3FBxR" target="_blank" class="btn-plan">Get Started</a>
                    </div>
                </div>
            </div>
            <div class="text-center mt-5">
                <button class="btn btn-link text-secondary text-decoration-none" data-bs-toggle="modal" data-bs-target="#paymentModal">
                    Already paid via bKash? <span class="text-primary fw-bold">Confirm Payment</span>
                </button>
            </div>
        </div>
    </div>

    <footer id="contact">
        <div class="container">
            <h4 class="text-white fw-bold mb-4">CaseReference BD</h4>
            <div class="mb-4">
                <a href="#" class="footer-link">Home</a>
                <a href="#packages" class="footer-link">Pricing</a>
                <a href="#" class="footer-link">Privacy Policy</a>
            </div>
            <p class="mb-1">Bashundhara Riverview, Dhaka.</p>
            <p class="mb-1">Email: legalvoicebd@gmail.com</p>
            <p class="mb-4">Phone: 01911 008 518</p>
            <p class="small opacity-50">&copy; 2026 CaseReference. All rights reserved.</p>
        </div>
    </footer>

    <a href="https://wa.me/8801911008518" class="whatsapp-float" target="_blank"><i class="fab fa-whatsapp"></i></a>

    <div class="modal fade" id="appModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-5 border-0">
                <div class="modal-body">
                    <i class="fas fa-android fa-4x text-success mb-3"></i>
                    <h3 class="fw-bold">Coming Soon!</h3>
                    <p class="text-muted mt-3">Our dedicated Android App is currently under development.</p>
                    <button class="btn btn-light rounded-pill px-4 mt-3" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-4">
                <div class="modal-header border-0 pb-0">
                    <h5 class="modal-title text-white">My Account</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center pt-4">
                    <div id="profileInfoLoader"><div class="spinner-border text-primary"></div></div>
                    <div id="profileContent" style="display:none;">
                        <i class="fas fa-user-circle fa-4x text-secondary mb-3"></i>
                        <h5 id="profileEmail" class="fw-bold mb-1"></h5>
                        <span id="profileStatus" class="badge bg-secondary mb-3">Free Member</span>
                        
                        <div class="card bg-light border-0 p-3 mt-3 text-start">
                            <p class="mb-1 small text-muted text-uppercase fw-bold">Subscription Details</p>
                            <div class="d-flex justify-content-between border-bottom pb-2 mb-2">
                                <span>Expiry Date:</span>
                                <span id="profileExpiry" class="fw-bold text-dark">-</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Days Remaining:</span>
                                <span id="profileDays" class="fw-bold text-primary">-</span>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-outline-danger w-100 mt-4" onclick="logout()">Sign Out</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="loginModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Member Login</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-4 text-center"><p class="text-muted mb-3">Login with your email address.</p><input type="email" id="loginEmailInput" class="form-control form-control-lg mb-3" placeholder="name@example.com"><button class="btn btn-dark w-100" onclick="submitLogin()">Send Magic Link</button></div></div></div></div>
    <div class="modal fade" id="checkEmailModal" tabindex="-1" data-bs-backdrop="static"><div class="modal-dialog modal-dialog-centered"><div class="modal-content text-center p-5"><div class="modal-body"><i class="fas fa-paper-plane fa-4x text-success mb-4"></i><h3 class="fw-bold mb-2">Check Your Email</h3><p class="text-muted">We have sent a login link to your email.</p><button type="button" class="btn btn-outline-success mt-3 px-4 rounded-pill" data-bs-dismiss="modal">OK</button></div></div></div></div>
    <div class="modal fade" id="premiumWarningModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header bg-warning"><h5 class="modal-title text-dark">üîí Login Required</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body p-4 text-center"><p class="lead">This is a <strong>Premium</strong> Judgment.</p><p class="text-muted mb-4">You need to login to read the full text.</p><button class="btn btn-dark w-100" onclick="triggerLoginFromModal()">Login Now</button></div></div></div></div>
    <div class="modal fade" id="advSearchGateModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content text-center p-5 border-0 shadow"><div class="modal-body"><i class="fas fa-check-circle fa-4x text-success mb-4"></i><h3 class="fw-bold text-dark">Judgment Found!</h3><p class="text-muted mt-3 mb-4">Great news! The case is in our database.<br>However, <b>Advanced Search</b> is a <b>Premium Feature</b>.</p><div class="d-grid gap-2"><button class="btn btn-dark" onclick="window.location.href='#packages'; bootstrap.Modal.getInstance(document.getElementById('advSearchGateModal')).hide();">View Plans</button><button class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button></div></div></div></div></div>
    <div class="modal fade" id="paymentModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"><i class="fas fa-file-invoice-dollar me-2"></i> Payment Verification</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-4"><form action="https://formsubmit.co/caseref.bd@gmail.com" method="POST"><input type="hidden" name="_captcha" value="false"><input type="hidden" name="_subject" value="New Payment"><div class="mb-3"><label class="form-label">Name</label><input type="text" name="Name" class="form-control" required></div><div class="mb-3"><label class="form-label">Phone</label><input type="text" name="Phone" class="form-control" required></div><div class="mb-3"><label class="form-label">Email</label><input type="email" name="Email" class="form-control" required></div><div class="row"><div class="col-6 mb-3"><label class="form-label">TrxID</label><input type="text" name="TrxID" class="form-control" required></div><div class="col-6 mb-3"><label class="form-label">Plan</label><select name="Package" class="form-select"><option>Monthly</option><option>Quarterly</option><option>Yearly</option></select></div></div><button class="btn btn-success w-100 py-2">Submit</button></form></div></div></div></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const supabaseUrl = 'https://bxzrydybnnlzrgzdqnob.supabase.co'; 
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4enJ5ZHlibm5senJnemRxbm9iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1NTQ2MzksImV4cCI6MjA4NDEzMDYzOX0.6Ikj5At5UKhKZr6y_lhmOQ-FUDxdnJOS1ZUSf6dTgEI'; 
        const githubUser = 'LexSwordBD'; 
        const repoName = 'casereference'; 
        const siteLink = 'https://lexswordbd.github.io/casereference/';

        const _supabase = supabase.createClient(supabaseUrl, supabaseKey);
        let currentUser = null;
        let subStatus = false;
        let currentPage = 1;
        const itemsPerPage = 20;
        let currentSearchType = 'simple';

        // --- RESTORED LOGIC ---
        // --- ‡ßß. ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶á‡¶® ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ (Smart Law Mapping) ---
        // ‡¶¨‡¶æ‡¶Æ ‡¶™‡¶æ‡¶∂‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶π‡ßÅ‡¶¨‡¶π‡ßÅ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ HTML Datalist ‡¶è‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡¶ø‡¶≤ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá
        const lawAliases = {
            'Constitution of Bangladesh (‡¶∏‡¶Ç‡¶¨‡¶ø‡¶ß‡¶æ‡¶®)': ['Constitution', 'Konstitution', 'Art.', 'Article', '‡¶∏‡¶Ç‡¶¨‡¶ø‡¶ß‡¶æ‡¶®'],
            
            // CPC ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø: 'Code of Civil Procedure', 'CPC', 'Order', 'Rule' ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶¨‡ßá
            'Code of Civil Procedure (CPC/‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶®‡ßÄ)': ['CPC', 'Code of Civil Procedure', 'Civil Procedure', 'C.P.C', '‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶®‡ßÄ', 'Order', 'Rule'],
            
            // CrPC ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø: 'CrPC', 'Criminal Procedure', '561A', '498' ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶¨‡ßá
            'Code of Criminal Procedure (CrPC/‡¶´‡ßå‡¶ú‡¶¶‡¶æ‡¶∞‡ßÄ)': ['CrPC', 'Code of Criminal Procedure', 'Criminal Procedure', 'Cr.P.C', '‡¶´‡ßå‡¶ú‡¶¶‡¶æ‡¶∞‡ßÄ', '561A', '498', 's. 144'],
            
            // Penal Code ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø: 'Penal', 'PC', 'dondobidhi', '302' ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶¨‡ßá‡•§ ‡¶∏‡¶æ‡¶≤ ‡¶¨‡¶æ ‡¶∞‡ßã‡¶Æ‡¶æ‡¶® ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶ì 'Penal' ‡¶∂‡¶¨‡ßç‡¶¶‡¶ü‡¶ø ‡¶•‡¶æ‡¶ï‡¶æ‡ßü ‡¶ß‡¶∞‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡•§
            'Penal Code (‡¶¶‡¶£‡ßç‡¶°‡¶¨‡¶ø‡¶ß‡¶ø)': ['Penal', 'PC', 'P.C', 'dondobidhi', '‡¶¶‡¶£‡ßç‡¶°‡¶¨‡¶ø‡¶ß‡¶ø', '302', '304', '1860'],
            
            'Evidence Act (‡¶∏‡¶æ‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶Ü‡¶á‡¶®)': ['Evidence', 'sakkho', 'sakhho', '‡¶∏‡¶æ‡¶ï‡ßç‡¶∑‡ßç‡¶Ø'],
            'Limitation Act (‡¶§‡¶æ‡¶Æ‡¶æ‡¶¶‡¶ø ‡¶Ü‡¶á‡¶®)': ['Limitation', 'Section 5', 'condonation', '‡¶§‡¶æ‡¶Æ‡¶æ‡¶¶‡¶ø'],
            'Specific Relief Act (‡¶∏‡ßÅ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡¶æ‡¶∞)': ['Specific Relief', 'SR Act', 'S.R. Act', '‡¶∏‡ßÅ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡¶æ‡¶∞'],
            
            'Nari O Shishu Nirjatan Daman Ain (‡¶®‡¶æ‡¶∞‡ßÄ ‡¶ì ‡¶∂‡¶ø‡¶∂‡ßÅ)': ['Nari O Shishu', 'Women and Children', 'Nari-O-Shishu', '‡¶®‡¶æ‡¶∞‡ßÄ ‡¶ì ‡¶∂‡¶ø‡¶∂‡ßÅ', '‡¶®‡¶æ‡¶∞‡ßÄ ‡¶∂‡¶ø‡¶∂‡ßÅ', 'Shishu'],
            
            'Artha Rin Adalat Ain (‡¶Ö‡¶∞‡ßç‡¶• ‡¶ã‡¶£ ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§)': ['Artha Rin', 'Money Loan', 'Adalat', '‡¶Ö‡¶∞‡ßç‡¶• ‡¶ã‡¶£'],
            'Digital Security Act (‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ)': ['Digital Security', 'Cyber', 'ICT Act', '‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ'],
            'Narcotics Control Act (‡¶Æ‡¶æ‡¶¶‡¶ï ‡¶¶‡ßç‡¶∞‡¶¨‡ßç‡¶Ø ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£)': ['Narcotics', 'Madok', 'Drug', 'Table', 'Yaba', 'Heroin', 'Phensedyl', '‡¶Æ‡¶æ‡¶¶‡¶ï'],
            'Special Powers Act (‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ)': ['Special Powers', 'SPA', 'Special Power', '‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ'],
            'Anti-Terrorism Act (‡¶∏‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶æ‡¶∏ ‡¶¨‡¶ø‡¶∞‡ßã‡¶ß‡ßÄ)': ['Anti-Terrorism', 'Terrorism', '‡¶∏‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶æ‡¶∏'],
            'Arms Act (‡¶Ö‡¶∏‡ßç‡¶§‡ßç‡¶∞ ‡¶Ü‡¶á‡¶®)': ['Arms Act', '‡¶Ö‡¶∏‡ßç‡¶§‡ßç‡¶∞'],
            'Ain Srinkhola Bighnokari (‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶¨‡¶ø‡¶ö‡¶æ‡¶∞)': ['Druto Bichar', 'Speedy Trial', '‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶¨‡¶ø‡¶ö‡¶æ‡¶∞'],
            'Mobile Court Act (‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶ï‡ßã‡¶∞‡ßç‡¶ü)': ['Mobile Court', '‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶ï‡ßã‡¶∞‡ßç‡¶ü'],
            
            'Transfer of Property Act (‡¶∏‡¶Æ‡ßç‡¶™‡¶§‡ßç‡¶§‡¶ø ‡¶π‡¶∏‡ßç‡¶§‡¶æ‡¶®‡ßç‡¶§‡¶∞)': ['Transfer of Property', 'TP Act', 'T.P. Act', '‡¶∏‡¶Æ‡ßç‡¶™‡¶§‡ßç‡¶§‡¶ø ‡¶π‡¶∏‡ßç‡¶§‡¶æ‡¶®‡ßç‡¶§‡¶∞'],
            'Contract Act (‡¶ö‡ßÅ‡¶ï‡ßç‡¶§‡¶ø ‡¶Ü‡¶á‡¶®)': ['Contract Act', 'Agreement', '‡¶ö‡ßÅ‡¶ï‡ßç‡¶§‡¶ø'],
            'Registration Act (‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®)': ['Registration', 'Section 17', '‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®'],
            'State Acquisition & Tenancy Act (‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨)': ['State Acquisition', 'SAT Act', 'Tenancy', '‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨'],
            'Vested Property Return Act (‡¶Ö‡¶∞‡ßç‡¶™‡¶ø‡¶§ ‡¶∏‡¶Æ‡ßç‡¶™‡¶§‡ßç‡¶§‡¶ø)': ['Vested Property', 'Enemy Property', '‡¶Ö‡¶∞‡ßç‡¶™‡¶ø‡¶§', 'Vested'],
            'Trust Act (‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶Ü‡¶á‡¶®)': ['Trust Act', 'Trustee'],
            
            'Muslim Family Laws (‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ ‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï ‡¶Ü‡¶á‡¶®)': ['Muslim Family', 'MFLO', 'Denmohar', 'Dower', 'Talaq'],
            'Family Courts Ordinance (‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§)': ['Family Courts', 'Family Court', '‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï'],
            'Guardians and Wards Act (‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï ‡¶ì ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶Ø)': ['Guardians and Wards', 'Guardian', 'Custody', '‡¶Ö‡¶≠‡¶ø‡¶≠‡¶æ‡¶¨‡¶ï'],
            
            'Negotiable Instruments Act (NI Act/‡¶ö‡ßá‡¶ï ‡¶°‡¶ø‡¶ú‡¶Ö‡¶®‡¶æ‡¶∞)': ['Negotiable Instruments', 'NI Act', 'N.I. Act', '138', 'Cheque', 'Dishonour', '‡¶ö‡ßá‡¶ï'],
            'Bangladesh Labor Act (‡¶∂‡ßç‡¶∞‡¶Æ ‡¶Ü‡¶á‡¶®)': ['Labor Act', 'Labour', 'Employment', 'Worker', '‡¶∂‡ßç‡¶∞‡¶Æ'],
            'Companies Act (‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø ‡¶Ü‡¶á‡¶®)': ['Companies Act', 'Company Law', 'Winding up', '‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø'],
            
            'VAT Act (‡¶≠‡ßç‡¶Ø‡¶æ‡¶ü ‡¶Ü‡¶á‡¶®)': ['Value Added Tax', 'VAT', '‡¶≠‡ßç‡¶Ø‡¶æ‡¶ü', 'Musok'],
            'Income Tax Ordinance (‡¶Ü‡ßü‡¶ï‡¶∞)': ['Income Tax', 'Tax', 'Taxes', '‡¶Ü‡ßü‡¶ï‡¶∞'],
            'Customs Act (‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶∏)': ['Customs', 'Custom'],
            'Right to Information Act (‡¶§‡¶•‡ßç‡¶Ø ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞)': ['Right to Information', 'RTI', '‡¶§‡¶•‡ßç‡¶Ø ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞']
        };
        const stopwords = ['a', 'an', 'the', 'of', 'in', 'and', 'or', 'is', 'are', 'was', 'were', 'be', 'to', 'for', 'with', 'on', 'at', 'by', 'from', 'shall', 'will', 'am'];

        // --- AUTH & PROFILE ---
        async function checkAuth() {
            const { data: { session } } = await _supabase.auth.getSession();
            const authDiv = document.getElementById('authDiv');
            
            if (session) {
                currentUser = session.user;
                fetchProfileData(); // Load data for modal
                authDiv.innerHTML = `<button class="btn btn-outline-dark rounded-pill px-3 btn-sm" data-bs-toggle="modal" data-bs-target="#profileModal"><i class="fas fa-user-circle"></i> Account</button>`;
            } else {
                authDiv.innerHTML = `<button class="btn btn-dark rounded-pill px-4 btn-sm" onclick="openLoginModal()">Login</button>`;
            }
        }
        
        async function fetchProfileData() {
            const { data } = await _supabase.from('members').select('*').eq('email', currentUser.email).single();
            const loader = document.getElementById('profileInfoLoader');
            const content = document.getElementById('profileContent');
            
            if(data && new Date(data.expiry_date) > new Date()) {
                subStatus = true;
                const expDate = new Date(data.expiry_date);
                const today = new Date();
                const diffTime = Math.abs(expDate - today);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                
                document.getElementById('profileEmail').innerText = currentUser.email;
                document.getElementById('profileStatus').className = "badge bg-success mb-3";
                document.getElementById('profileStatus').innerText = "Premium Member";
                document.getElementById('profileExpiry').innerText = expDate.toDateString();
                document.getElementById('profileDays').innerText = diffDays + " days";
            } else {
                subStatus = false;
                document.getElementById('profileEmail').innerText = currentUser.email;
                document.getElementById('profileStatus').innerText = "Free Member";
                document.getElementById('profileExpiry').innerText = "N/A";
                document.getElementById('profileDays').innerText = "0";
            }
            loader.style.display = 'none';
            content.style.display = 'block';
        }
        checkAuth();

        function openLoginModal() { new bootstrap.Modal(document.getElementById('loginModal')).show(); }
        async function submitLogin() {
            const email = document.getElementById('loginEmailInput').value;
            if(!email) return alert("Please enter email.");
            bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
            const { error } = await _supabase.auth.signInWithOtp({ email, options: { emailRedirectTo: siteLink } });
            if(!error) new bootstrap.Modal(document.getElementById('checkEmailModal')).show();
            else alert(error.message);
        }
        function triggerLoginFromModal() { bootstrap.Modal.getInstance(document.getElementById('premiumWarningModal')).hide(); openLoginModal(); }
        async function logout() { await _supabase.auth.signOut(); location.reload(); }

        // --- SEARCH ENGINE ---
        function resetHome() { location.reload(); }
        function toggleAdvSearch() { const p = document.getElementById('advSearchForm'); p.style.display = p.style.display === 'block' ? 'none' : 'block'; }
        
        async function showMyBookmarks() {
            if(!currentUser) { openLoginModal(); return; }
            document.getElementById('homeSection').classList.add('hero-shrunk'); // Collapse Hero
            document.getElementById('featuresSection').style.display = 'none';
            document.getElementById('resultsArea').innerHTML = "";
            document.getElementById('readerView').style.display = "none";
            document.getElementById('bookmarkArea').style.display = 'block';
            
            const list = document.getElementById('bookmarkList');
            list.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-secondary"></div></div>';
            const { data } = await _supabase.from('bookmarks').select('*').eq('email', currentUser.email);
            if(!data || data.length === 0) { list.innerHTML = '<div class="alert alert-light border">No bookmarks found.</div>'; return; }
            list.innerHTML = "";
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'result-item';
                div.onclick = () => loadJudgment({title: item.case_title, citation: item.case_citation, case_anchor: item.case_anchor, github_filename: item.github_filename, is_premium: true});
                div.innerHTML = `<h5>${item.case_title}</h5><span class="badge bg-light text-dark border">${item.case_citation}</span>`;
                list.appendChild(div);
            });
        }

        function triggerSearch(page, type = null) { if (type) currentSearchType = type; performSearch(page); }

        async function performSearch(page = 1) {
            currentPage = page;
            document.getElementById('readerView').style.display = 'none';
            document.getElementById('bookmarkArea').style.display = 'none';
            document.getElementById('featuresSection').style.display = 'none';
            document.getElementById('packages').style.display = 'none';
            
            // HERO COLLAPSE LOGIC (SCROLL FIX)
            document.getElementById('homeSection').classList.add('hero-shrunk');

            const resultsDiv = document.getElementById('resultsArea');
            const lawFilterVal = document.getElementById('lawFilterInput').value.trim();
            const searchText = document.getElementById('searchInput').value.trim();

            if (currentSearchType !== 'advanced' && !searchText && !lawFilterVal) { alert("Please enter keyword."); return; }

            resultsDiv.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-primary"></div></div>';
            
            let queryBuilder = _supabase.from('cases').select('*', { count: 'exact' });
            let highlightTerm = "";

            if (currentSearchType === 'advanced') {
                const jour = document.getElementById('advJournal').value;
                const vol = document.getElementById('advVol').value;
                const div = document.getElementById('advDiv').value;
                const pg = document.getElementById('advPage').value;
                if (!jour || !vol || !div || !pg) { alert("Fill all fields."); return; }
                queryBuilder = queryBuilder.eq('journal', jour).eq('volume', vol).eq('division', div).eq('page_number', pg);
                highlightTerm = `${jour} ${vol} ${pg}`;
            } else {
                // --- ‡ß®. ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶≤‡¶ú‡¶ø‡¶ï ---
                const isExact = document.getElementById('exactMatchToggle').checked;
                
                // ‡¶ï) ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßç‡¶∞‡¶™‡¶°‡¶æ‡¶â‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
                let aliasCondition = "";
                if(lawFilterVal) {
                    // ‡¶°‡ßç‡¶∞‡¶™‡¶°‡¶æ‡¶â‡¶®‡ßá‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ '‡¶°‡¶æ‡¶ï‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ' (lawAliases) ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡¶¨‡ßç‡¶¶‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶®‡¶¨
                    // ‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ 'CPC' ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶™‡¶æ‡¶¨: ['CPC', 'Code of Civil Procedure', 'Order', ...]
                    const aliases = lawAliases[lawFilterVal] || [lawFilterVal];
                    
                    // ‡¶è‡¶¨‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶¨‡ßá‡¶ú‡¶ï‡ßá ‡¶¨‡¶≤‡¶¨: ‡¶π‡ßá‡¶°‡¶®‡ßã‡¶ü‡ßá ‡¶¨‡¶æ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤‡ßá ‡¶è‡¶á ‡¶∂‡¶¨‡ßç‡¶¶‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï‡¶ü‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶á ‡¶π‡¶¨‡ßá
                    // ‡¶Ü‡¶Æ‡¶∞‡¶æ 'headnote' ‡¶è‡¶¨‡¶Ç 'title' ‡¶¶‡ßÅ‡¶ü‡ßã‡¶§‡ßá‡¶á ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶¨ ‡¶Ø‡¶æ‡¶§‡ßá ‡¶Æ‡¶ø‡¶∏ ‡¶®‡¶æ ‡¶π‡ßü
                    const headnoteChecks = aliases.map(a => `headnote.ilike.%${a}%`).join(',');
                    const titleChecks = aliases.map(a => `title.ilike.%${a}%`).join(',');
                    
                    // ‡¶∏‡¶¨ ‡¶Æ‡¶ø‡¶≤‡¶ø‡ßü‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡ßú ‡¶∂‡¶∞‡ßç‡¶§ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶≤‡ßã
                    aliasCondition = headnoteChecks + ',' + titleChecks;
                }

                if (isExact) {
                    // ‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶ï‡ßç‡¶ü ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶≤‡¶ú‡¶ø‡¶ï
                    let queryStr = `headnote.ilike.%${searchText}%,title.ilike.%${searchText}%`;
                    if(aliasCondition) {
                        // ‡¶Ø‡¶¶‡¶ø ‡¶≤-‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶¨‡ßá ‡¶≤-‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá
                        queryBuilder = queryBuilder.or(aliasCondition).or(queryStr);
                    } else {
                        queryBuilder = queryBuilder.or(queryStr);
                    }
                    highlightTerm = searchText;
                } else {
                    // ‡¶®‡¶∞‡¶Æ‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶≤‡¶ú‡¶ø‡¶ï (‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü)
                    const words = searchText.split(/\s+/).filter(w => !stopwords.includes(w.toLowerCase()) && w.length > 1);
                    
                    // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶Ø‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßá‡¶õ‡ßá ‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø
                    let textCondition = "";
                    if (words.length > 0) {
                        textCondition = words.map(w => `headnote.ilike.%${w}%,title.ilike.%${w}%`).join(',');
                    } else if (searchText) {
                        textCondition = `headnote.ilike.%${searchText}%,title.ilike.%${searchText}%`;
                    }
                    
                    // ‡¶∏‡ßÅ‡¶™‡¶æ‡¶¨‡ßá‡¶ú‡¶ï‡ßá ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ
                    if(aliasCondition && textCondition) {
                        // ‡¶Ü‡¶á‡¶®‡¶ì ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá, ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¨‡¶ï‡ßç‡¶∏‡ßá‡¶ì ‡¶≤‡¶ø‡¶ñ‡ßá‡¶õ‡ßá -> ‡¶¶‡ßÅ‡¶ü‡ßã‡¶á ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶¨
                        queryBuilder = queryBuilder.or(aliasCondition + ',' + textCondition);
                    } else if (aliasCondition) {
                        // ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ü‡¶á‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá
                        queryBuilder = queryBuilder.or(aliasCondition);
                    } else if (textCondition) {
                        // ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶≤‡¶ø‡¶ñ‡ßá‡¶õ‡ßá
                        queryBuilder = queryBuilder.or(textCondition);
                    }
                    
                    highlightTerm = words.join('|');
                }
            }

            const from = (page - 1) * itemsPerPage;
            const to = from + itemsPerPage - 1;
            const { data, error, count } = await queryBuilder.range(from, to).order('page_number', { ascending: true });

            if (currentSearchType === 'advanced' && (!currentUser || !subStatus)) {
                if (count > 0) {
                    new bootstrap.Modal(document.getElementById('advSearchGateModal')).show();
                    resultsDiv.innerHTML = '';
                    return;
                }
            }

            if (error || !data || data.length === 0) {
                resultsDiv.innerHTML = '<div class="text-center mt-5 text-muted"><h5>No cases found.</h5></div>';
                return;
            }

            resultsDiv.innerHTML = `<p class="text-muted small mb-3">Found ${count} results</p>`;
            
            data.forEach(item => {
                const safeHeadnote = item.headnote || "";
                const highlightedHeadnote = highlightText(safeHeadnote, highlightTerm || lawFilterVal);
                
                let citationHtml = (currentUser && subStatus) 
                    ? `<span class="badge bg-light text-dark border">${item.citation}</span> ${item.parallel_citations ? '| ' + item.parallel_citations : ''}`
                    : `<span class="badge bg-secondary text-white"><i class="fas fa-lock"></i> Premium</span>`;

                const div = document.createElement('div');
                div.className = 'result-item';
                div.onclick = () => loadJudgment(item);
                div.innerHTML = `
                    <h5>${item.title}</h5>
                    <div class="mb-2">${citationHtml} <span class="text-muted small">${item.division || ''}</span></div>
                    <div class="headnote-text">${highlightedHeadnote}</div>
                `;
                resultsDiv.appendChild(div);
            });
            renderPagination(count, page);
        }

        function renderPagination(totalItems, currentPage) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const nav = document.getElementById('paginationNav');
            const list = document.getElementById('paginationList');
            if (totalPages <= 1) { nav.style.display = 'none'; return; }
            nav.style.display = 'block'; list.innerHTML = '';
            
            let start = Math.max(1, currentPage - 2);
            let end = Math.min(totalPages, start + 4);
            
            list.innerHTML += `<li class="page-item ${currentPage===1?'disabled':''}"><button class="page-link" onclick="triggerSearch(${currentPage-1})"><</button></li>`;
            for(let i=start; i<=end; i++) {
                list.innerHTML += `<li class="page-item ${i===currentPage?'active':''}"><button class="page-link" onclick="triggerSearch(${i})">${i}</button></li>`;
            }
            list.innerHTML += `<li class="page-item ${currentPage===totalPages?'disabled':''}"><button class="page-link" onclick="triggerSearch(${currentPage+1})">></button></li>`;
        }

        function highlightText(text, keyword) {
            if (!keyword) return text;
            const parts = keyword.split('|').filter(k => k.length > 0);
            let highlighted = text;
            parts.forEach(part => {
                try {
                    const regex = new RegExp(`(${part})`, "gi");
                    highlighted = highlighted.replace(regex, '<span class="highlight">$1</span>');
                } catch(e) {}
            });
            return highlighted;
        }

        async function loadJudgment(item) {
            if (item.is_premium && !currentUser) { new bootstrap.Modal(document.getElementById('premiumWarningModal')).show(); return; }
            if (item.is_premium && !subStatus) { document.getElementById('paywallMsg').style.display = 'block'; document.getElementById('resultsArea').innerHTML = ''; return; }
            
            document.getElementById('resultsArea').innerHTML = '';
            document.getElementById('paginationNav').style.display = 'none';
            const viewer = document.getElementById('readerView');
            viewer.style.display = 'block';
            viewer.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-secondary"></div></div>';
            
            try {
                const url = `https://raw.githubusercontent.com/${githubUser}/${repoName}/main/judgments/${item.github_filename}`;
                const res = await fetch(url);
                const fullText = await res.text();
                const start = `===${item.case_anchor}===`;
                const end = `===End===`;
                const sIdx = fullText.indexOf(start);
                let content = sIdx !== -1 ? fullText.substring(sIdx + start.length, fullText.indexOf(end, sIdx)) : "Content Error";
                const searchTerm = document.getElementById('searchInput').value;
                if(searchTerm) content = highlightText(content, searchTerm.replace(/\s+/g, '|'));

                viewer.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                        <button class="btn btn-outline-secondary btn-sm" onclick="triggerSearch(${currentPage})"><i class="fas fa-arrow-left"></i> Back</button>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-warning text-dark" onclick="toggleBookmark('${item.title}', '${item.citation}', '${item.case_anchor}', '${item.github_filename}')"><i class="far fa-bookmark"></i> Save</button>
                            <button class="btn btn-sm btn-outline-dark" onclick="window.print()"><i class="fas fa-print"></i> Print</button>
                        </div>
                    </div>
                    <h3 class="fw-bold text-center text-primary mb-2" style="font-family:'Playfair Display'">${item.title}</h3>
                    <p class="text-center text-muted fw-bold mb-4">${item.citation}</p>
                    <div class="mt-4 text-justify" style="white-space: pre-wrap; font-family:'Merriweather'">${content}</div>
                `;
            } catch (e) { viewer.innerHTML = "Error loading judgment."; }
        }

        async function toggleBookmark(title, citation, anchor, file) {
            if(!currentUser) { openLoginModal(); return; }
            const { error } = await _supabase.from('bookmarks').insert([{ email: currentUser.email, case_title: title, case_citation: citation, case_anchor: anchor, github_filename: file }]);
            if(error) alert("Already saved."); else alert("Saved!");
        }
    </script>
</body>
</html>
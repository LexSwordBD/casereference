<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CaseReference | Legal Research Platform</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap');
        
        :root {
            --primary-grad: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            --accent-color: #d35400;
            --text-dark: #2c3e50;
        }

        body { background-color: #f4f7f6; font-family: 'Hind Siliguri', sans-serif; overflow-x: hidden; }
        
        /* ‡¶®‡ßç‡¶Ø‡¶æ‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® */
        .navbar { background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.05); padding: 12px 0; }
        .navbar-brand { font-size: 24px; font-weight: 700; color: var(--text-dark) !important; }
        .navbar-brand span { color: var(--accent-color); }
        .nav-link { font-weight: 600; color: #555; margin: 0 10px; font-size: 16px; cursor: pointer; }

        /* ‡¶π‡¶ø‡¶∞‡ßã ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        .hero-section { 
            background: var(--primary-grad); 
            padding: 60px 15px 80px 15px; 
            text-align: center; color: white; 
            border-bottom-left-radius: 20px; border-bottom-right-radius: 20px;
        }
        .hero-title { font-size: 38px; font-weight: 700; margin-bottom: 10px; }
        .hero-subtitle { font-size: 16px; opacity: 0.9; margin-bottom: 30px; }

        /* ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶¨‡¶æ‡¶∞ (‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶°) */
        .search-container { max-width: 750px; margin: 0 auto; position: relative; }
        .search-wrapper {
            background: #fff; border-radius: 50px; padding: 5px 5px 5px 25px;
            display: flex; align-items: center; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: 0.3s; height: 60px;
        }
        .search-input { border: none; outline: none; flex-grow: 1; font-size: 18px; color: #333; background: transparent; height: 100%; }
        .btn-filter { background: none; border: none; color: #777; font-size: 20px; padding: 0 15px; border-left: 1px solid #eee; height: 30px; display: flex; align-items: center; }
        .btn-search { 
            background: var(--accent-color); color: white; border: none;
            width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 18px; flex-shrink: 0; box-shadow: 0 4px 10px rgba(211, 84, 0, 0.3);
        }
        .btn-search:active { transform: scale(0.95); }

        /* ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ */
        .adv-search-panel { display: none; background: #fff; border-radius: 12px; padding: 20px; margin-top: 15px; text-align: left; color: #333; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }

        /* ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        .features-section { 
            padding: 40px 15px; background: #fff; 
            margin-top: -40px; 
            border-radius: 20px; position: relative; z-index: 10; 
            max-width: 1000px; margin-left: auto; margin-right: auto; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.03); 
        }
        .feature-icon { font-size: 28px; color: var(--accent-color); margin-bottom: 10px; }

        /* ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
        .result-card { 
            background: white; padding: 25px; border-radius: 10px; margin-bottom: 20px; 
            border-left: 5px solid var(--accent-color); box-shadow: 0 2px 8px rgba(0,0,0,0.05); 
            cursor: pointer;
        }
        .headnote-text { 
            text-align: justify; font-size: 15px; line-height: 1.7; color: #2c3e50; margin-top: 15px;
            white-space: pre-wrap; font-family: 'Times New Roman', serif;
        }
        .highlight { background-color: #ffeb3b; padding: 0 2px; border-radius: 2px; font-weight: bold; }

        /* ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø */
        .packages-section { padding: 50px 15px; }
        .package-card { background: white; border-radius: 15px; padding: 25px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.05); margin-bottom: 20px; transition: 0.3s; }
        .package-card:hover { transform: translateY(-5px); border: 1px solid var(--accent-color); }
        .btn-pay { display: block; width: 100%; background: var(--text-dark); color: white; padding: 10px; border-radius: 8px; text-decoration: none; margin-top: 15px; }

        footer { background: #222; color: #bbb; padding: 40px 0; font-size: 14px; }
        .whatsapp-float { position: fixed; bottom: 20px; right: 20px; width: 55px; height: 55px; background-color: #25d366; color: white; border-radius: 50%; text-align: center; line-height: 55px; font-size: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); z-index: 1000; }

        /* ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶´‡¶∞‡¶Æ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .modal-header { background: #2c3e50; color: white; border-bottom: none; }
        .modal-content { border-radius: 15px; border: none; overflow: hidden; }
        .form-label { font-weight: 600; font-size: 14px; margin-bottom: 5px; }
        .form-control, .form-select { border-radius: 5px; padding: 10px; }
        .btn-close-white { filter: invert(1); }

        @media (max-width: 768px) {
            .hero-title { font-size: 28px; }
            .hero-section { padding-bottom: 40px; }
            .features-section { margin-top: 20px !important; width: 95%; }
            .search-input { font-size: 16px; padding-left: 15px; }
            .search-wrapper { height: 55px; }
            .btn-search { width: 45px; height: 45px; }
            .col-6 { padding: 5px; }
        }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="location.reload()">Case<span>Reference</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="fas fa-bars border py-2 px-3 rounded"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center mt-3 mt-lg-0">
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#" onclick="resetHome()">‡¶π‡ßã‡¶Æ</a></li>
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#packages">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú</a></li>
                    <li class="nav-item"><a class="nav-link nav-link-close" href="#contact">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a></li>
                    <li class="nav-item ms-lg-2 mt-2 mt-lg-0" id="authDiv"></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="hero-section" id="homeSection">
        <div class="container">
            <h1 class="hero-title">Welcome to Case Reference</h1>
            <p class="hero-subtitle">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Ü‡¶á‡¶®‡¶æ‡¶ô‡ßç‡¶ó‡¶®‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶∏‡ßç‡¶§ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶π‡¶Ø‡ßã‡¶ó‡ßÄ</p>
            
            <div class="search-container">
                <div class="search-wrapper">
                    <input type="text" id="searchInput" class="search-input" placeholder="‡¶ï‡ßÄ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶§‡ßá ‡¶ö‡¶æ‡¶®? (‡¶Ø‡ßá‡¶Æ‡¶®: Murder)...">
                    <button class="btn-filter" onclick="toggleAdvSearch()" title="Advanced Filter"><i class="fas fa-sliders-h"></i></button>
                    <button class="btn-search" onclick="performSearch('simple')"><i class="fas fa-search"></i></button>
                </div>

                <div class="adv-search-panel" id="advSearchForm">
                    <h6 class="text-primary mb-3 border-bottom pb-2" style="font-size:14px; font-weight:700;">ADVANCED FILTER (ALL REQUIRED)</h6>
                    <div class="row g-2">
                        <div class="col-6 col-md-3">
                            <label class="small fw-bold text-muted">Journal</label>
                            <select id="advJournal" class="form-select form-select-sm"><option value="">Select</option><option value="DLR">DLR</option><option value="BLD">BLD</option><option value="ADC">ADC</option></select>
                        </div>
                        <div class="col-6 col-md-2">
                            <label class="small fw-bold text-muted">Vol</label>
                            <input type="text" id="advVol" class="form-control form-control-sm" placeholder="75">
                        </div>
                        <div class="col-6 col-md-3">
                            <label class="small fw-bold text-muted">Division</label>
                            <select id="advDiv" class="form-select form-select-sm"><option value="">Any</option><option value="AD">AD</option><option value="HCD">HCD</option></select>
                        </div>
                        <div class="col-6 col-md-2">
                            <label class="small fw-bold text-muted">Page</label>
                            <input type="text" id="advPage" class="form-control form-control-sm" placeholder="45">
                        </div>
                        <div class="col-12 col-md-2 d-flex align-items-end">
                            <button class="btn btn-dark btn-sm w-100 mt-2 mt-md-0" onclick="performSearch('advanced')">Find Case</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="features-section" id="featuresSection">
        <div class="row text-center g-3">
            <div class="col-6 col-md-3"><i class="fas fa-bolt feature-icon"></i><h6 class="fw-bold">‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö</h6></div>
            <div class="col-6 col-md-3"><i class="fas fa-database feature-icon"></i><h6 class="fw-bold">‡¶¨‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶æ‡¶á‡¶≠</h6></div>
            <div class="col-6 col-md-3"><i class="fas fa-mobile-alt feature-icon"></i><h6 class="fw-bold">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶≤‡¶ø</h6></div>
            <div class="col-6 col-md-3"><i class="fas fa-headset feature-icon"></i><h6 class="fw-bold">‡ß®‡ß™/‡ß≠ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</h6></div>
        </div>
    </div>

    <div class="container mt-4">
        <div id="resultsArea"></div>
        <div id="readerView" class="p-4 bg-white rounded shadow-sm border" style="display:none; margin-bottom:50px; font-family: 'Times New Roman', serif;"></div>
        <div id="paywallMsg" class="text-center py-5 bg-white rounded shadow-sm border" style="display:none; margin-bottom:50px;">
            <i class="fas fa-crown fa-3x text-warning mb-3"></i>
            <h3>Premium Access Required</h3>
            <p class="text-muted">‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞‡¶∂‡¶ø‡¶™ ‡¶∞‡¶ø‡¶®‡¶ø‡¶â ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§</p>
            <a href="#packages" class="btn btn-primary rounded-pill px-4">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</a>
        </div>
    </div>

    <div class="packages-section" id="packages">
        <div class="container">
            <h3 class="text-center fw-bold mb-4">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü <span style="color:var(--accent-color)">‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span></h3>
            
            <div class="row g-3 justify-content-center">
                <div class="col-md-3 col-sm-6">
                    <div class="package-card">
                        <i class="fas fa-calendar-day"></i>
                        <h5>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï</h5>
                        <div class="h3 fw-bold my-2">‡ßß‡ßØ‡ßØ‡ß≥</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt199/4NosNL" target="_blank" class="btn-pay">Pay Now</a>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="package-card" style="border: 2px solid var(--accent-color);">
                        <span class="badge bg-danger position-absolute top-0 end-0 m-2">Best</span>
                        <i class="fas fa-calendar-alt"></i>
                        <h5>‡¶§‡ßç‡¶∞‡ßà‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï</h5>
                        <div class="h3 fw-bold my-2">‡ß™‡ßØ‡ßØ‡ß≥</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt499/IxcDIa" target="_blank" class="btn-pay">Pay Now</a>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="package-card">
                        <i class="fas fa-calendar-check"></i>
                        <h5>‡¶∑‡¶æ‡¶®‡ßç‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï</h5>
                        <div class="h3 fw-bold my-2">‡ß≠‡ß¶‡ß¶‡ß≥</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt700/LO7ESu" target="_blank" class="btn-pay">Pay Now</a>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="package-card">
                        <i class="fas fa-award"></i>
                        <h5>‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï</h5>
                        <div class="h3 fw-bold my-2">‡ßß‡ß®‡ß¶‡ß¶‡ß≥</div>
                        <a href="https://shop.bkash.com/ak-jurist-law-firm01911008518/pay/bdt1200/O3FBxR" target="_blank" class="btn-pay">Pay Now</a>
                    </div>
                </div>
            </div>

            <div class="text-center mt-5">
                <button class="btn btn-success btn-lg px-5 rounded-pill shadow" data-bs-toggle="modal" data-bs-target="#paymentModal">
                    <i class="fas fa-check-double me-2"></i> ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
            </div>
        </div>
    </div>

    <footer id="contact">
        <div class="container text-center">
            <h5 class="fw-bold">CaseReference BD</h5>
            <p class="mb-1 text-light small">Bashundhara Riverview, Dhaka.</p>
            <p class="mb-3 text-light small">Contact: 01911 008 518 | Email: legalvoicebd@gmail.com</p>
            <hr style="border-color: #555;">
            <p class="mb-0 small text-secondary">&copy; 2026 CaseReference. All Rights Reserved.</p>
        </div>
    </footer>

    <a href="https://wa.me/8801911008518" class="whatsapp-float" target="_blank"><i class="fab fa-whatsapp"></i></a>

    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Member Login</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 text-center">
                    <p class="text-muted mb-3">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶è‡¶°‡ßç‡¶∞‡ßá‡¶∏ ‡¶¶‡¶ø‡ßü‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ú‡¶ø‡¶ï ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡¶æ‡¶†‡¶æ‡¶¨‡ßã‡•§</p>
                    <input type="email" id="loginEmailInput" class="form-control form-control-lg mb-3" placeholder="name@example.com">
                    <button class="btn btn-dark w-100" onclick="submitLogin()">Send Magic Link</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="checkEmailModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-5">
                <div class="modal-body">
                    <div class="mb-4">
                        <i class="fas fa-paper-plane fa-4x text-success"></i>
                    </div>
                    <h3 class="fw-bold mb-2">Check Your Email</h3>
                    <p class="text-muted">‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶≤‡¶ó‡¶á‡¶® ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá‡¶õ‡¶ø‡•§ ‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶á‡¶®‡¶¨‡¶ï‡ßç‡¶∏ (‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶™‡ßç‡¶Ø‡¶æ‡¶Æ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞) ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                    <button type="button" class="btn btn-outline-success mt-3 px-4 rounded-pill" data-bs-dismiss="modal">OK, I Will Check</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="premiumWarningModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title text-dark">üîí Login Required</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 text-center">
                    <p class="lead">‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø <strong>Premium</strong> ‡¶ú‡¶æ‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡•§</p>
                    <p class="text-muted mb-4">‡¶™‡ßÅ‡¶∞‡ßã ‡¶∞‡¶æ‡ßü ‡¶™‡ßú‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§</p>
                    <button class="btn btn-dark w-100" onclick="triggerLoginFromModal()">Login Now</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="paymentModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-file-invoice-dollar me-2"></i> ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶´‡¶∞‡¶Æ</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="paymentForm" action="https://formsubmit.co/caseref.bd@gmail.com" method="POST">
                        <input type="hidden" name="_captcha" value="false">
                        <input type="hidden" name="_subject" value="New Payment Request">
                        <input type="hidden" name="_template" value="table">
                        <div class="mb-3"><label class="form-label">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" name="Name" class="form-control" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" required></div>
                        <div class="mb-3"><label class="form-label">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ / ‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</label><input type="text" name="Phone" class="form-control" placeholder="017XXXXXXXX" required></div>
                        <div class="mb-3"><label class="form-label">‡¶≤‡¶ó‡¶á‡¶® ‡¶á‡¶Æ‡ßá‡¶á‡¶≤</label><input type="email" name="Email" class="form-control" placeholder="example@gmail.com" required></div>
                        <div class="row">
                            <div class="col-md-6 mb-3"><label class="form-label">Transaction ID (TrxID)</label><input type="text" name="TrxID" class="form-control" placeholder="TXN123456" required></div>
                            <div class="col-md-6 mb-3"><label class="form-label">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú</label><select name="Package" class="form-select" required><option value="Monthly (199)">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï (‡ßß‡ßØ‡ßØ‡ß≥)</option><option value="Quarterly (499)">‡¶§‡ßç‡¶∞‡ßà‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï (‡ß™‡ßØ‡ßØ‡ß≥)</option><option value="Half-Yearly (700)">‡¶∑‡¶æ‡¶®‡ßç‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï (‡ß≠‡ß¶‡ß¶‡ß≥)</option><option value="Yearly (1200)">‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï (‡ßß‡ß®‡ß¶‡ß¶‡ß≥)</option></select></div>
                        </div>
                        <div class="d-grid mt-3"><button type="submit" class="btn btn-primary btn-lg">‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button></div>
                        <p class="text-muted small text-center mt-2">‡¶§‡¶•‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§</p>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4">
                <div class="modal-body">
                    <h4 class="fw-bold mb-3">My Account</h4>
                    <div id="profileInfo">Checking...</div>
                    <button class="btn btn-outline-danger btn-sm mt-3 px-4" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const supabaseUrl = 'https://bxzrydybnnlzrgzdqnob.supabase.co'; 
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4enJ5ZHlibm5senJnemRxbm9iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1NTQ2MzksImV4cCI6MjA4NDEzMDYzOX0.6Ikj5At5UKhKZr6y_lhmOQ-FUDxdnJOS1ZUSf6dTgEI'; 
        const githubUser = 'LexSwordBD'; 
        const repoName = 'casereference'; 
        const siteLink = 'https://lexswordbd.github.io/casereference/';

        const _supabase = supabase.createClient(supabaseUrl, supabaseKey);
        let currentUser = null;
        let subStatus = false;
        let subExpiry = "";

        async function checkAuth() {
            const { data: { session } } = await _supabase.auth.getSession();
            const authDiv = document.getElementById('authDiv');
            if (session) {
                currentUser = session.user;
                const { data } = await _supabase.from('members').select('*').eq('email', currentUser.email).single();
                
                if(data && new Date(data.expiry_date) > new Date()) {
                    subStatus = true;
                    subExpiry = new Date(data.expiry_date).toDateString();
                } else {
                    subStatus = false;
                    subExpiry = "Expired / Free";
                }

                authDiv.innerHTML = `<button class="btn btn-outline-dark btn-sm rounded-pill px-3 fw-bold" data-bs-toggle="modal" data-bs-target="#profileModal"><i class="fas fa-user-circle"></i> ${subStatus ? 'Premium' : 'My Account'}</button>`;
                document.getElementById('profileInfo').innerHTML = `<p class="fw-bold text-primary mb-1">${currentUser.email}</p><span class="badge ${subStatus ? 'bg-success' : 'bg-warning text-dark'}">${subStatus ? 'Active' : 'Expired'}</span><p class="small text-muted mt-2">Valid Till: ${subExpiry}</p>`;
            } else {
                authDiv.innerHTML = `<button class="btn btn-dark btn-sm rounded-pill px-4 fw-bold" onclick="openLoginModal()">Login</button>`;
            }
        }
        checkAuth();

        // ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡ßá)
        function openLoginModal() {
            document.getElementById('loginEmailInput').value = ''; // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞
            new bootstrap.Modal(document.getElementById('loginModal')).show();
        }

        // ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function submitLogin() {
            const email = document.getElementById('loginEmailInput').value;
            if(!email) {
                alert("Please enter a valid email."); // ‡¶∏‡¶ø‡¶Æ‡ßç‡¶™‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
                return;
            }
            
            // ‡¶≤‡¶ó‡¶á‡¶® ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ
            bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();

            const { error } = await _supabase.auth.signInWithOtp({ email, options: { emailRedirectTo: siteLink } });
            
            if(!error) {
                // ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
                new bootstrap.Modal(document.getElementById('checkEmailModal')).show();
            } else {
                alert("Error: " + error.message);
            }
        }

        // ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡¶æ‡¶ì‡ßü‡¶æ
        function triggerLoginFromModal() {
            bootstrap.Modal.getInstance(document.getElementById('premiumWarningModal')).hide();
            openLoginModal();
        }

        async function logout() { await _supabase.auth.signOut(); location.reload(); }
        function toggleAdvSearch() { document.getElementById('advSearchForm').style.display = document.getElementById('advSearchForm').style.display === 'block' ? 'none' : 'block'; }
        
        function resetHome() { location.reload(); }

        document.querySelectorAll('.nav-link-close').forEach(item => {
            item.addEventListener('click', () => {
                const toggler = document.querySelector('.navbar-toggler');
                const collapse = document.querySelector('.navbar-collapse');
                if (window.getComputedStyle(toggler).display !== 'none' && collapse.classList.contains('show')) toggler.click();
            });
        });

        function showSection(sec) { 
            document.getElementById('packages').style.display = 'block'; 
            document.getElementById('featuresSection').style.display = 'block';
            document.getElementById('homeSection').scrollIntoView({behavior: 'smooth'}); 
        }

        async function performSearch(type) {
            const resultsDiv = document.getElementById('resultsArea');
            document.getElementById('readerView').style.display = 'none';
            document.getElementById('paywallMsg').style.display = 'none';
            document.getElementById('packages').style.display = 'none';
            document.getElementById('featuresSection').style.display = 'none';
            document.getElementById('homeSection').style.padding = "20px 0";

            if (type !== 'advanced' && !document.getElementById('searchInput').value.trim()) {
                alert("‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§");
                return;
            }

            resultsDiv.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-primary"></div></div>';
            
            let queryBuilder = _supabase.from('cases').select('*');
            let highlightTerm = "";

            if (type === 'advanced') {
                const jour = document.getElementById('advJournal').value;
                const vol = document.getElementById('advVol').value;
                const div = document.getElementById('advDiv').value;
                const pg = document.getElementById('advPage').value;
                
                if (!jour || !vol || !div || !pg) { 
                    alert("Advanced Search-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨ ‡¶ò‡¶∞ (Journal, Vol, Division, Page) ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶¨‡¶æ‡¶ß‡ßç‡¶Ø‡¶§‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï‡•§");
                    resultsDiv.innerHTML = "";
                    document.getElementById('featuresSection').style.display = 'block';
                    return; 
                }
                
                queryBuilder = queryBuilder
                    .eq('journal', jour)
                    .eq('volume', vol)
                    .eq('division', div)
                    .eq('page_number', pg);
                    
                highlightTerm = `${jour} ${vol} ${pg}`;
            } else {
                const text = document.getElementById('searchInput').value;
                queryBuilder = queryBuilder.or(`headnote.ilike.%${text}%,title.ilike.%${text}%`);
                highlightTerm = text;
            }

            const { data, error } = await queryBuilder.limit(20);

            if (error || !data.length) {
                resultsDiv.innerHTML = '<div class="text-center mt-5 text-muted"><h5>No cases found.</h5></div>';
                document.getElementById('packages').style.display = 'block';
                return;
            }

            resultsDiv.innerHTML = `<p class="text-muted small mb-3 ms-1">Found ${data.length} results</p>`;
            data.forEach(item => {
                const safeHeadnote = item.headnote || "";
                const highlightedHeadnote = highlightText(safeHeadnote, highlightTerm);
                const div = document.createElement('div');
                div.className = 'result-card';
                div.onclick = () => loadJudgment(item);
                div.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <h5 class="mb-1" style="color:#1a237e; font-weight:700;">${item.title}</h5>
                        ${item.is_premium ? '<i class="fas fa-lock text-danger small"></i>' : '<i class="fas fa-unlock text-success small"></i>'}
                    </div>
                    <div><span class="badge bg-light text-dark border">${item.citation}</span> <span class="small text-muted ms-1">${item.division || ''}</span></div>
                    <div class="headnote-text">${highlightedHeadnote}</div>
                `;
                resultsDiv.appendChild(div);
            });
        }

        function highlightText(text, keyword) {
            if (!keyword) return text;
            const regex = new RegExp(`(${keyword})`, "gi");
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        async function loadJudgment(item) {
            // ‡ßß. ‡¶≤‡¶ó‡¶á‡¶® ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡¶æ‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
            if (item.is_premium && !currentUser) { 
                new bootstrap.Modal(document.getElementById('premiumWarningModal')).show();
                return; 
            }
            if (item.is_premium && !subStatus) { 
                document.getElementById('resultsArea').innerHTML = '';
                document.getElementById('paywallMsg').style.display = 'block';
                document.getElementById('packages').style.display = 'block';
                return; 
            }
            document.getElementById('resultsArea').innerHTML = '';
            const viewer = document.getElementById('readerView');
            viewer.style.display = 'block';
            viewer.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-secondary"></div></div>';
            
            try {
                const url = `https://raw.githubusercontent.com/${githubUser}/${repoName}/main/judgments/${item.github_filename}`;
                const res = await fetch(url);
                const fullText = await res.text();
                const start = `===${item.case_anchor}===`;
                const end = `===End===`;
                const sIdx = fullText.indexOf(start);
                let content = sIdx !== -1 ? fullText.substring(sIdx + start.length, fullText.indexOf(end, sIdx)) : "Content Error";
                
                const searchTerm = document.getElementById('searchInput').value;
                if(searchTerm) content = highlightText(content, searchTerm);

                viewer.innerHTML = `
                    <button class="btn btn-light btn-sm mb-3 border" onclick="location.reload()"><i class="fas fa-arrow-left"></i> Back</button>
                    <h4 class="text-center fw-bold" style="color:#1a237e">${item.title}</h4>
                    <p class="text-center text-muted fw-bold border-bottom pb-3">${item.citation}</p>
                    <div class="mt-4" style="text-align: justify; font-size:18px; line-height:1.8; white-space: pre-wrap;">${content}</div>
                `;
            } catch (e) { viewer.innerHTML = "Error loading judgment."; }
        }
    </script>
</body>
</html>